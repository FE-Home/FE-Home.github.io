---
title: 从零开始node（四）：工具
date: 2018-10-21 19:06:45
tags:
  - node
---

# 从零开始 node（四）：工具

> 工欲善其事，必先利其器。

<!--more-->

## Linux 下的安装

在 Windows 和 macOS 平台，node 都有可视化界面来进行安装，在 Linux 平台就需要使用命令行来安装。常用的方法有以下几种：

### 包管理工具

比如 ubuntu 的 apt，使用这种方法安装 node 的缺陷是版本不可控，且更新较慢。

### 下载源码编译安装

使用这种方法需要一个单核能力较强的 CPU，由于我在日常开发的时候使用的都是云服务器，1Core1G 的配置使编译过程变得非常的长。

### 下载编译后的包

使用 curl 或者 wget 工具在 nodejs 官网下载已经编译好的包，如`https://nodejs.org/dist/latest/node-v10.12.0-linux-x64.tar.gz`，解压后 cp 到/usr/local 即可使用。缺点是难以进行版本管理。

## 版本管理

### nvm/n

- n

n 是一个 npm 上的包，也就是说安装了 npm node 才可以安装 n，使用过程非常简单，只需一个命令`n`就可以使用上下箭头来切换 node 版本，而且切换版本的时候全局安装的包不受影响。缺点是不支持 Windows。

- nvm

nvm 是一个独立的软件，在\*nix，macOS，Windows 都有稳定的表现，而且可以实现不同的终端窗口使用不同版本的 node。缺点是切换版本的时候全局安装的包也会随之切换。

## 守护进程

从日常开发到正式部署上线，肯定不会采用`node app.js`的方法来启动 node 进程，因为随时有可能退出，并且会随着命令行窗口的关闭而关闭。在这里介绍三种守护进程用的包，`supervisor`/`forever`/`pm2`

### supervisor

一般用于开发环境，在保存代码后不用手动重启进程，supervisor 会自动重启，类似的还有 nest.js 脚手架默认使用的工具 nodemon。

### forever

forever 是一个简单的工具，仅用于保持脚本持续运行，虽然它也有日志工具，但是在管理大型集群的情况下还是略显吃力。在我的使用历史来看，forever 守护博客最长曾经保持过两个月不宕机（不排除服务器不稳定的原因）

### pm2

相比于前两种工具，pm2 就显得更加专业了，不仅可以守护进程，还可以做负载均衡、日志管理、状态监控等，满足了大型 node 项目的稳定运行。详细使用参见：[pm2](https://pm2.io/doc/zh/runtime/quick-start/)
